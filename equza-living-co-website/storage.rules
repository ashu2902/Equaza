rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // Simplified rules: Read access for all, full access for admins
    match /{allPaths=**} {
      allow read: if true; // Public read access for all files
      allow write, update, delete, create: if isAdmin(); // Full access for admins
    }
    
    // Special case: Allow anonymous uploads for customization forms (temp storage)
    match /uploads/temp/{sessionId}/{allPaths=**} {
      allow create: if true; // Allow anonymous uploads for customize form
      allow read, write, update, delete: if true; // Allow reading uploaded files
    }
    
    // Helper function to check admin permissions
    function isAdmin() {
      return request.auth != null && request.auth.token.admin == true;
    }
  }
} 